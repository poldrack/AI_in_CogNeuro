<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.54">

  <meta name="author" content="Russ Poldrack">
  <title>AI-assisted coding: Experiments with GPT-4</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="./images/stanford_background.jpg" data-background-opacity="0.5" class="quarto-title-block center">
  <h1 class="title">AI-assisted coding: Experiments with GPT-4</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Russ Poldrack 
</div>
        <p class="quarto-title-affiliation">
            Professor, Department of Psychology
          </p>
        <p class="quarto-title-affiliation">
            Associate Director, Stanford Data Science
          </p>
        <p class="quarto-title-affiliation">
            Stanford University
          </p>
    </div>
</div>

</section>
<section id="section" class="slide level2" data-background-image="images/openai_gpt-4_visual-e1678820006678.jpg" data-background-size="100%" data-background-opacity=".05">
<h2></h2>
<div class="absolute" style="font-size: 1.5em; text-align: center;top: 40%; ">
<p>How many of you have used AI to help with coding?</p>
</div>
</section>
<section id="todays-punch-lines" class="slide level2" data-background-image="images/transformer.png" data-background-size="100%" data-background-opacity=".06">
<h2>Today’s punch lines</h2>
<ul>
<li>Large language models (LLMs) are powerful coding assistants, but have important shortcomings
<ul>
<li>If you are not using them to help write code, you are probably throwing away time</li>
</ul></li>
<li>LLMs pose fundamental questions about how to educate and to assess learning of coding skills</li>
</ul>
<div class="absolute" style="font-size: 1em; text-align: center;top: 85%; left: 27%; ">
<p>https://arxiv.org/abs/2304.13187</p>
</div>
</section>
<section id="openai-codex" class="slide level2" data-background-image="images/openai-codex.png" data-background-size="100%" data-background-opacity=".05">
<h2>OpenAI Codex</h2>
<ul>
<li>Released August 2021</li>
<li>Based on GPT-3
<ul>
<li>Trained on a large body of publicly available source code including 150+ GB of Python code from 54M public GitHub repositories</li>
</ul></li>
<li>“Our results show that Codex performs better than most students on code writing questions in typical first year programming exams” (Finnie-Ansley, 2022)</li>
<li>Deprecated in March 2023 in favor of GPT-3.5</li>
</ul>
</section>
<section id="github-copilot" class="slide level2">
<h2>Github Copilot</h2>
<iframe data-external="1" src="https://www.youtube.com/embed/mHDnIm-GU4o" width="80%" height="80%" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</section>
<section id="gpt-4-codes-at-human-level" class="slide level2">
<h2>GPT-4 codes at human level</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>GPT-4 released March 14, 2023</li>
<li>AI systems were given problems from the LeetCode platform for coding practice/testing
<ul>
<li>only problems posted after the GPT-4 training period ended (Sept 2021)</li>
</ul></li>
<li>GPT-4 performs on par with human LeetCode users</li>
</ul>
</div><div class="column" style="width:50%;">
<div id="c2ef7044" class="cell" data-fig-width="100%" data-execution_count="1">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="talk_files/figure-revealjs/cell-2-output-1.png" class="quarto-figure quarto-figure-center" width="844" height="538"></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="absolute" style="font-size: 0.8em; text-align: center;top: 88%; left: 70%; ">
<p>Bubeck et al., 2023</p>
</div>
</section>
<section id="incremental-improvements-on-gpt-4" class="slide level2">
<h2>Incremental improvements on GPT-4</h2>
<div class="columns">
<div class="column" style="font-size: 0.8em;">
<ul>
<li>Since early 2023 improvements have been incremental
<ul>
<li>Most have been based on GPT-4 with improved prompting techniques or additional training data</li>
</ul></li>
<li>GPT-4 still dominates but open-source models are catching up
<ul>
<li>DeepSeek-Coder-V2 is now comparable to GPT-4</li>
</ul></li>
</ul>
</div></div>
<p><img data-src="images/humaneval.png" class="absolute" style="top: 20%; left: 50%; height: 50%; "></p>
<div class="absolute" style="font-size: 0.5em; text-align: center;top: 80%; left: 50%; ">
<p>HumanEval: 164 coding problems with 8 tests each https://paperswithcode.com/sota/code-generation-on-humaneval</p>
</div>
</section>
<section id="why-coding-is-an-optimal-use-case-for-llms" class="slide level2">
<h2>Why coding is an optimal use case for LLMs</h2>
<ul>
<li>LLMs are most useful in cases where work is difficult to generate but relatively easy to verify
<ul>
<li>It’s trivially easy to test whether code is syntatically correct</li>
<li>It’s usually straightforward to generate automated tests to determine whether code is functioning correctly</li>
</ul></li>
</ul>
</section>
<section id="experiments-with-gpt-4" class="slide level2">
<h2>Experiments with GPT-4</h2>
<ul>
<li>Experiments performed in March 2023
<ul>
<li>Before multimodal support</li>
<li>Before supposed degradation of GPT-4 performance in mid-2023 (Chen et al, 2023)</li>
</ul></li>
</ul>
</section>
<section id="experiment-1-interactive-coding-with-gpt-4" class="slide level2">
<h2>Experiment 1: Interactive coding with GPT-4</h2>
<ul>
<li>Presented GPT-4 (via ChatGPT Plus) with 32 coding problems
<ul>
<li>Primarily focused on data science/statistics/ML and text mining</li>
</ul></li>
<li>Caveats:
<ul>
<li>User was fairly novice with prompt engineering</li>
<li>Assessment was completely subjective and qualitative</li>
</ul></li>
</ul>
</section>
<section id="gpt-4-coding-performance" class="slide level2">
<h2>GPT-4 coding performance</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div id="dd8ecd5a" class="cell" data-fig-width="100%" data-execution_count="2">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="talk_files/figure-revealjs/cell-3-output-1.png" width="851" height="537"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="font-size: 0.8em;">
<ul>
<li>Median 69 lines of code (31-161)</li>
<li>“Success” defined as running with no errors and giving a result that was reasonably close to intended result (by my subjective judgment)</li>
<li>“NS” meant that a relatively novice user (i.e.&nbsp;me) was not able to easily prompt a successful solution (i.e.&nbsp;w/in a few mins of effort)</li>
</ul>
</div></div>
</section>
<section id="example-of-gpt-4-one-shot-success" class="slide level2">
<h2>Example of GPT-4 one-shot success</h2>

<img data-src="images/overfitting_prompt.png" class="r-stretch"></section>
<section id="example-of-gpt-4-one-shot-success-1" class="slide level2" style="font-size: 1.5em;">
<h2>Example of GPT-4 one-shot success</h2>
<div id="71fcab1c" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-4"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb1-5"><a></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb1-6"><a></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb1-7"><a></a></span>
<span id="cb1-8"><a></a><span class="co"># 1. Generate synthetic data</span></span>
<span id="cb1-9"><a></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-10"><a></a>mean <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb1-11"><a></a>cov <span class="op">=</span> [[<span class="dv">1</span>, <span class="fl">0.5</span>], [<span class="fl">0.5</span>, <span class="dv">1</span>]]</span>
<span id="cb1-12"><a></a>train_data <span class="op">=</span> np.random.multivariate_normal(mean, cov, <span class="dv">32</span>)</span>
<span id="cb1-13"><a></a>test_data <span class="op">=</span> np.random.multivariate_normal(mean, cov, <span class="dv">32</span>)</span>
<span id="cb1-14"><a></a></span>
<span id="cb1-15"><a></a>X_train <span class="op">=</span> train_data[:, <span class="dv">0</span>].reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb1-16"><a></a>y_train <span class="op">=</span> train_data[:, <span class="dv">1</span>]</span>
<span id="cb1-17"><a></a></span>
<span id="cb1-18"><a></a>X_test <span class="op">=</span> test_data[:, <span class="dv">0</span>].reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb1-19"><a></a>y_test <span class="op">=</span> test_data[:, <span class="dv">1</span>]</span>
<span id="cb1-20"><a></a></span>
<span id="cb1-21"><a></a><span class="co"># 2. Fit three models</span></span>
<span id="cb1-22"><a></a>linear_model <span class="op">=</span> LinearRegression().fit(X_train, y_train)</span>
<span id="cb1-23"><a></a>second_order_model <span class="op">=</span> make_pipeline(PolynomialFeatures(<span class="dv">2</span>), LinearRegression()).fit(X_train, y_train)</span>
<span id="cb1-24"><a></a>ninth_order_model <span class="op">=</span> make_pipeline(PolynomialFeatures(<span class="dv">9</span>), LinearRegression()).fit(X_train, y_train)</span>
<span id="cb1-25"><a></a></span>
<span id="cb1-26"><a></a><span class="co"># 3. Compute errors</span></span>
<span id="cb1-27"><a></a>models <span class="op">=</span> [linear_model, second_order_model, ninth_order_model]</span>
<span id="cb1-28"><a></a>train_errors <span class="op">=</span> [mean_squared_error(y_train, model.predict(X_train)) <span class="cf">for</span> model <span class="kw">in</span> models]</span>
<span id="cb1-29"><a></a>test_errors <span class="op">=</span> [mean_squared_error(y_test, model.predict(X_test)) <span class="cf">for</span> model <span class="kw">in</span> models]</span>
<span id="cb1-30"><a></a></span>
<span id="cb1-31"><a></a><span class="bu">print</span>(<span class="st">"Training errors:"</span>, train_errors)</span>
<span id="cb1-32"><a></a><span class="bu">print</span>(<span class="st">"Test errors:"</span>, test_errors)</span>
<span id="cb1-33"><a></a></span>
<span id="cb1-34"><a></a><span class="co"># 4. Plot fitted lines</span></span>
<span id="cb1-35"><a></a>plt.scatter(X_train, y_train, color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Training data'</span>)</span>
<span id="cb1-36"><a></a></span>
<span id="cb1-37"><a></a>X_line <span class="op">=</span> np.linspace(X_train.<span class="bu">min</span>(), X_train.<span class="bu">max</span>(), <span class="dv">100</span>).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb1-38"><a></a>colors <span class="op">=</span> [<span class="st">'green'</span>, <span class="st">'red'</span>, <span class="st">'purple'</span>]</span>
<span id="cb1-39"><a></a>labels <span class="op">=</span> [<span class="st">'Linear'</span>, <span class="st">'2nd-order'</span>, <span class="st">'9th-order'</span>]</span>
<span id="cb1-40"><a></a></span>
<span id="cb1-41"><a></a><span class="cf">for</span> i, model <span class="kw">in</span> <span class="bu">enumerate</span>(models):</span>
<span id="cb1-42"><a></a>    plt.plot(X_line, model.predict(X_line), color<span class="op">=</span>colors[i], label<span class="op">=</span>labels[i])</span>
<span id="cb1-43"><a></a></span>
<span id="cb1-44"><a></a>plt.legend()</span>
<span id="cb1-45"><a></a>plt.xlabel(<span class="st">'Variable 1'</span>)</span>
<span id="cb1-46"><a></a>plt.ylabel(<span class="st">'Variable 2'</span>)</span>
<span id="cb1-47"><a></a>plt.title(<span class="st">'Fitted lines for different models'</span>)</span>
<span id="cb1-48"><a></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-of-gpt-4-one-shot-success-2" class="slide level2">
<h2>Example of GPT-4 one-shot success</h2>
<div id="de839aab" class="cell" data-fig.height="8" data-fig.width="12" data-execution_count="4">
<div class="cell-output cell-output-stdout">
<pre><code>Training errors: [np.float64(0.5941676382175597), np.float64(0.5933518294151625), np.float64(0.5129192853729938)]
Test errors: [np.float64(0.7419748200389997), np.float64(0.7229125040492909), np.float64(0.9712589627709035)]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="talk_files/figure-revealjs/cell-5-output-2.png" width="1017" height="716"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<div class="absolute" style="font-size: 1.5em; text-align: center;top: 25%; left: 0%; ">
<p>GPT-4 is quite good at explaining the conceptual intent of code</p>
</div>
</section>
<section id="gpt-4-explanation" class="slide level2">
<h2>GPT-4 explanation</h2>

<img data-src="images/overfitting_explanation.png" class="r-stretch"></section>
<section id="gpt-4-explanation-1" class="slide level2">
<h2>GPT-4 explanation</h2>

<img data-src="images/clt2_prompt.jpeg" class="r-stretch"></section>
<section id="gpt-4-explanation-2" class="slide level2">
<h2>GPT-4 explanation</h2>

<!--
## GPT-4 "understanding" 

![](images/clt2_description.jpeg)
-->
<img data-src="images/clt2_histograms.png" class="r-stretch"></section>
<section id="gpt-4-explanation-3" class="slide level2">
<h2>GPT-4 explanation</h2>

<img data-src="images/clt2_prompt2.jpeg" class="r-stretch"></section>
<section id="gpt-4-explanation-4" class="slide level2">
<h2>GPT-4 explanation</h2>

<img data-src="images/clt2_explanation_part1.jpeg" class="r-stretch"></section>
<section id="gpt-4-explanation-5" class="slide level2">
<h2>GPT-4 explanation</h2>

<img data-src="images/clt2_explanation_part2.jpeg" class="r-stretch"></section>
<section id="interactive-debugging-with-gpt-4" class="slide level2">
<h2>Interactive debugging with GPT-4</h2>
<ul>
<li>11/32 attempts required additional prompting to solve the problem</li>
<li>Common problems
<ul>
<li>Use of outdated package features</li>
<li>Type errors (e.g.&nbsp;accessing a list as if it were a dict)</li>
<li>Hallucinating non-existent packages or methods</li>
<li>Use of inappropriate methods for particular data</li>
</ul></li>
</ul>
</section>
<section id="an-example-of-interactive-debugging" class="slide level2" style="font-size: 1.5em;">
<h2>An example of interactive debugging</h2>

<img data-src="images/hurdle1.png" class="r-stretch"></section>
<section id="an-example-of-interactive-debugging-1" class="slide level2" style="font-size: 1.5em;">
<h2>An example of interactive debugging</h2>
<div style="font-size: 1.5em;">
<pre><code>self.continuous_model = LinearRegression()</code></pre>
</div>

<img data-src="images/hurdle3.png" class="r-stretch"></section>
<section id="an-example-of-interactive-debugging-2" class="slide level2" style="font-size: 1.5em;">
<h2>An example of interactive debugging</h2>
<div style="font-size: 1.5em;">
<pre><code>ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 1</code></pre>
</div>

<img data-src="images/hurdle4.png" class="r-stretch"></section>
<section id="an-example-of-interactive-debugging-3" class="slide level2" style="font-size: 1.5em;">
<h2>An example of interactive debugging</h2>

<img data-src="images/hurdle_r.png" class="r-stretch"></section>
<section id="an-example-of-interactive-debugging-4" class="slide level2" style="font-size: 1.5em;">
<h2>An example of interactive debugging</h2>
<ul>
<li>Initial comparison using in-sample train/test data</li>
</ul>
<div style="font-size: 1.5em;">
<pre><code>$ python hurdle4.py 
Mean squared error: 7.750558995547416</code></pre>
<pre><code>$ Rscript hurdle.R
[1] "Mean squared error: 108.965835640358"</code></pre>
</div>
<ul>
<li>After additional manual (human only) debugging: <!--
  - GPT-4 had miscoded the prediction for the R code
  - Turned off regularization for the python regression methods
--></li>
</ul>
<div style="font-size: 1.5em;">
<pre><code>$ python hurdle5.py 
Mean squared error: 5.198941931090807</code></pre>
<pre><code>$ Rscript hurdle_insample.R 
[1] "Mean squared error: 5.04963049849389"</code></pre>
</div>
</section>
<section id="llms-inherit-the-stupidity-of-crowds" class="slide level2" style="font-size: 1.5em;">
<h2>LLMs inherit the stupidity of crowds</h2>
<ul>
<li>GPT-4 estimates the hurdle model in an incorrect way
<ul>
<li>All other Python implementations of the model on Github use this incorrect approach</li>
</ul></li>
</ul>
</section>
<section id="gpt-4-coding-failures" class="slide level2">
<h2>GPT-4 coding failures</h2>
<ul>
<li>9/32 attempts did not lead to a successful outcome
<ul>
<li>Number of additional prompts ranged from 1-4</li>
<li>One case was a system problem with a required library</li>
</ul></li>
</ul>
<!--
## The drift diffusion model of decision making

![](images/ddmfig.png)

-->
</section>
<section id="example-the-ez-diffusion-model" class="slide level2">
<h2>Example: The EZ-diffusion model</h2>
<blockquote>
<p>The EZ-diffusion model for two-choice response time tasks takes mean response time, the variance of response time, and response accuracy as inputs. The model transforms these data via three simple equations to produce unique values for the quality of information, response conservativeness, and nondecision time. (Wagenmakers et al., 2007)</p>
</blockquote>

<img data-src="images/ezdiff_v_equation.png" class="r-stretch"></section>
<section id="prompting-gpt-4-for-the-ez-diffusion-model" class="slide level2">
<h2>Prompting GPT-4 for the EZ-diffusion model</h2>

<img data-src="images/ezdiff1.png" class="r-stretch"></section>
<section id="gpt-4-misunderstanding" class="slide level2">
<h2>GPT-4 misunderstanding</h2>
<div style="font-size: 1.5em;">
<pre><code>result = minimize(ez_diffusion_loss, initial_guess, bounds=bounds)</code></pre>
</div>
</section>
<section id="gpt-4-misunderstanding-1" class="slide level2">
<h2>GPT-4 misunderstanding</h2>
<div style="font-size: 1.5em;">
<pre><code>result = minimize(ez_diffusion_loss, initial_guess, bounds=bounds)</code></pre>
</div>

<img data-src="images/ezdiff2.png" class="r-stretch"></section>
<section id="gpt-4-mathematical-hallucination" class="slide level2">
<h2>GPT-4 mathematical hallucination</h2>
<div style="font-size: 1.25em;">
<pre><code>def ez_diffusion(response_times, decisions):
    accuracy = np.mean(decisions &gt; 0)
    rt_mean = np.mean(response_times)
    rt_var = np.var(response_times)
    
    v = np.sqrt(np.pi) * (4 * accuracy * (1 - accuracy) / (rt_var / rt_mean ** 2 - 1)) ** (1 / 4)
    a = rt_mean * (1 - 2 * accuracy) * v / (4 * accuracy * (1 - accuracy))
    z = a / 2</code></pre>
</div>
<div class="absolute" style="font-size: 0.8em; text-align: center;top: 53%; left: 15%; ">
<p>Correct equation</p>
</div>
<p><img data-src="images/ezdiff_v_equation.png" class="absolute" style="top: 60%; left: 0%; width: 50%; "></p>
<div class="absolute" style="font-size: 0.8em; text-align: center;top: 53%; left: 68%; ">
<p>GPT-4 equation</p>
</div>
<p><img data-src="images/ez_math_gpt4.png" class="absolute" style="top: 60%; left: 55%; width: 40%; "></p>
</section>
<section id="can-multimodal-gpt-4-with-web-access-get-it-right" class="slide level2">
<h2>Can multimodal GPT-4 with web access get it right?</h2>
<p><img data-src="images/ez_equation_question.png"></p>
<p><img data-src="images/ez_equation_answer.png"></p>
</section>
<section id="section-2" class="slide level2">
<h2></h2>

<img data-src="images/ez_cant_find_paper.png" class="r-stretch"></section>
<section id="section-3" class="slide level2">
<h2></h2>

<img data-src="images/ez_equation_from_image.png" class="r-stretch"></section>
<section id="experiment-1-summary" class="slide level2">
<h2>Experiment 1: Summary</h2>
<ul>
<li>GPT-4 is often very successful at generating useful code
<ul>
<li>But it sometimes fails spectacularly, especially with math</li>
</ul></li>
<li>GPT-4 does not provide any signals regarding relative confidence in the answer
<ul>
<li>The matter-of-fact nature of the answers tends to imply confidence</li>
</ul></li>
<li>All answers need to be verified
<ul>
<li>“Care should be taken when using the outputs of GPT-4, particularly in contexts where reliability is important” (GPT-4 Technical Report)</li>
</ul></li>
</ul>
</section>
<section id="experiment-3-generating-code-and-tests" class="slide level2">
<h2>Experiment 3: Generating code and tests</h2>
<ul>
<li>GPT-4 used to programmatically generate 20 coding problems in each of 5 domains (statistical and data science, physics, theoretical computer science, ecology, economics)
<ul>
<li>e.g.&nbsp;“Please generate 20 prompts to ask a chatbot to create Python code to solve a variety of physics problems.”</li>
</ul></li>
</ul>
</section>
<section id="example-prompt" class="slide level2">
<h2>Example prompt</h2>
<ul>
<li>“Create a Python function to model the population growth of a species using the logistic growth equation, given the initial population size, carrying capacity, and growth rate. <em>Please embed the code within an explicit code block, surrounded by triple-backtick markers. Generate realistic values for any examples, and do not use input() commands. Create code that is modular and well-commented. Then, generate a set of pytest tests that exercise each of the functions, embedded in a separate code block.</em>” (Italicized text added)</li>
</ul>
</section>
<section id="gpt-4-coding-results" class="slide level2">
<h2>GPT-4 coding results</h2>
<ul>
<li>GPT-4 successfully generated code and tests for each prompt</li>
<li>97% of the resulting code executed successfully without errors</li>
</ul>
</section>
<section id="gpt-4-test-generation-results" class="slide level2">
<h2>GPT-4 test generation results</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Code coverage
<ul>
<li>Assessed using Coverage.py</li>
</ul></li>
<li>60% of tests had 100% line coverage</li>
</ul>
</div><div class="column" style="width:50%;">
<div id="6bd92e66" class="cell" data-fig.height="12" data-fig.width="12" data-execution_count="5">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="talk_files/figure-revealjs/cell-6-output-1.png" width="712" height="685"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="gpt-4-testing-results" class="slide level2">
<h2>GPT-4 testing results</h2>
<ul>
<li>All tests successfully executed using pytest
<ul>
<li>All tests passed for 46</li>
<li>At least 1 tests failed for 54</li>
</ul></li>
<li>Primary causes of failure:
<ul>
<li>Failure of assertion (45)</li>
<li>Failure to properly raise error (11)</li>
</ul></li>
</ul>
</section>
<section id="gpt-4-testing-results-1" class="slide level2" style="font-size: 1.4em;">
<h2>GPT-4 testing results</h2>
<pre><code>mass_jupiter = 1.8982e27
radius_jupiter = 6.9911e7
result = escape_velocity(mass_jupiter, radius_jupiter)
assert pytest.approx(result, rel=1e-3) == 59564.97

E       assert 60202.716344497014 ± 6.0e+01 == 59564.97
E         comparison failed
E         Obtained: 59564.97
E         Expected: 60202.716344497014 ± 6.0e+01</code></pre>
<ul>
<li>In this case, the code and test value are both correct, depending on where you stand on Jupiter!
<ul>
<li>NASA’s Jupiter fact sheet claims an escape velocity of 59.5 km/s, which seems to be the source of the test value</li>
<li>This is correct when computed using the equatorial radius of 71492 km</li>
<li>The value generated by the code (60.2 km/s) is correct when computed using the volumetric mean radius (69911 km)</li>
</ul></li>
</ul>
<!-- https://nssdc.gsfc.nasa.gov/planetary/factsheet/jupiterfact.html -->
<!--
## AI as a coding partner

- Github CoPilot has cemented the role of AI coding assistants in practice
- How can AI help us write better code?
-->
</section>
<section id="ai-code-review" class="slide level2">
<h2>AI code review</h2>
<ul>
<li>Code review is essential for improving code quality
<ul>
<li>But many researchers do not have access to experts to help review their code</li>
</ul></li>
<li>GPT-4 seems to be quite good at reviewing code</li>
<li>This could be a huge win for scientific code quality and coding education</li>
</ul>
</section>
<section id="ai-code-review-an-example" class="slide level2">
<h2>AI code review: An example</h2>
<ul>
<li>Intentionally obfuscated Python code</li>
</ul>
<div id="ee2668bc" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a><span class="im">from</span> pandas <span class="im">import</span> <span class="op">*</span></span>
<span id="cb13-2"><a></a><span class="im">from</span> numpy <span class="im">import</span> <span class="op">*</span></span>
<span id="cb13-3"><a></a><span class="im">from</span> scipy.stats <span class="im">import</span> <span class="op">*</span></span>
<span id="cb13-4"><a></a>maxD <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb13-5"><a></a>hc <span class="op">=</span> [<span class="st">'Nervous'</span>, <span class="st">'Hopeless'</span>, <span class="st">'RestlessFidgety'</span>, <span class="st">'Depressed'</span>, <span class="st">'EverythingIsEffort'</span>, <span class="st">'Worthless'</span>, ]</span>
<span id="cb13-6"><a></a>h<span class="op">=</span>read_csv(<span class="st">'https://raw.githubusercontent.com/poldrack/clean_coding/master/data/health.csv'</span>,index_col<span class="op">=</span><span class="dv">0</span>)[hc].dropna().mean(<span class="dv">1</span>)</span>
<span id="cb13-7"><a></a>data<span class="op">=</span>read_csv(<span class="st">'https://raw.githubusercontent.com/poldrack/clean_coding/master/data/meaningful_variables_clean.csv'</span>,index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb13-8"><a></a>sc<span class="op">=</span>[]</span>
<span id="cb13-9"><a></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(data.shape[<span class="dv">1</span>]):</span>
<span id="cb13-10"><a></a>    <span class="cf">if</span> data.columns[i].split(<span class="st">'.'</span>)[<span class="dv">0</span>][<span class="op">-</span><span class="dv">7</span>:] <span class="op">==</span> <span class="st">'_survey'</span>:</span>
<span id="cb13-11"><a></a>        sc<span class="op">=</span>sc<span class="op">+</span>[data.columns[i]]</span>
<span id="cb13-12"><a></a>data<span class="op">=</span>data[sc]</span>
<span id="cb13-13"><a></a>gs<span class="op">=</span>[]</span>
<span id="cb13-14"><a></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(data.shape[<span class="dv">0</span>]):</span>
<span id="cb13-15"><a></a>    <span class="cf">if</span> <span class="bu">sum</span>(isnan(data.iloc[i, :])) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb13-16"><a></a>        <span class="cf">pass</span></span>
<span id="cb13-17"><a></a>    <span class="cf">else</span>:</span>
<span id="cb13-18"><a></a>        gs<span class="op">=</span>gs<span class="op">+</span>[i]</span>
<span id="cb13-19"><a></a>data<span class="op">=</span>data.iloc[gs,:]</span>
<span id="cb13-20"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> scale</span>
<span id="cb13-21"><a></a>data_sc <span class="op">=</span> scale(data)</span>
<span id="cb13-22"><a></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> FactorAnalysis</span>
<span id="cb13-23"><a></a>bicv<span class="op">=</span>zeros(maxD)</span>
<span id="cb13-24"><a></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,maxD<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb13-25"><a></a>    fa<span class="op">=</span>FactorAnalysis(i)</span>
<span id="cb13-26"><a></a>    fa.fit(data_sc)</span>
<span id="cb13-27"><a></a>    bicv[i<span class="op">-</span><span class="dv">1</span>]<span class="op">=</span>i<span class="op">*</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>fa.score(data_sc)</span>
<span id="cb13-28"><a></a>npD<span class="op">=</span>argmin(bicv)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb13-29"><a></a>fa<span class="op">=</span>FactorAnalysis(npD)</span>
<span id="cb13-30"><a></a>f<span class="op">=</span>fa.fit_transform(data_sc)</span>
<span id="cb13-31"><a></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(npD):</span>
<span id="cb13-32"><a></a>    <span class="bu">print</span>(pearsonr(f[:,i],h[gs]))</span>
<span id="cb13-33"><a></a>    idx<span class="op">=</span>argsort(<span class="bu">abs</span>(fa.components_[i, :]))[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb13-34"><a></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb13-35"><a></a>        <span class="bu">print</span>(data.columns[idx[j]], fa.components_[i, idx[j]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="absolute" style="font-size: 0.8em; text-align: center;top: 88%; left: 25%; ">
<p>https://github.com/poldrack/clean_coding</p>
</div>
<!--
## AI code explanation

![](images/obfuscated_code_explanation.png)

-->
</section>
<section id="ai-code-review-an-example-1" class="slide level2">
<h2>AI code review: An example</h2>
<p><img data-src="images/obfuscated_antipatterns_prompt.png" class="absolute" style="width: 70%; "></p>
</section>
<section id="ai-code-review-an-example-2" class="slide level2">
<h2>AI code review: An example</h2>

<!--

## GPT-4 improves "maintainability"


::::{.columns}
::: {.column width="45%"}
- Code maintainability is a holistic metric based on several sub-metrics:
  - Halstead volume (fx of # of operators & operands)
  - Cyclomatic complexity (# of independent paths through code)
  - Lines of code
  - % of comments
:::
::::

![](images/mi_mi_swarmplot.png){.absolute top=20% left=50% height=60%}

:::{.absolute top=85% left=68%}
FDR p < .01
:::

:::{.absolute top=10% left=58%}
Improved maintainabilty
:::

## {data-background-image="images/openai_gpt-4_visual-e1678820006678.jpg" data-background-size="100%" data-background-opacity=".05"}

::: {.absolute top=40%  left=8% style="font-size: 1.5em; text-align: center;"} 
Can GPT-4 successfully test its own code?
:::

-->
<img data-src="images/obfuscated_antipatterns_cropped.png" class="r-stretch"></section>
<section id="can-it-find-analytic-errors" class="slide level2">
<h2>Can it find analytic errors?</h2>
<ul>
<li>Presented ChatGPT with a (GPT-4) generated python script that performs cross-validated classification, with feature selection improperly performed outside of the crossvalidation loop.</li>
</ul>
<div id="ad34b374" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a>selector <span class="op">=</span> SelectKBest(score_func<span class="op">=</span>f_classif, k<span class="op">=</span>k)</span>
<span id="cb14-2"><a></a>X_selected <span class="op">=</span> selector.fit_transform(X, y)</span>
<span id="cb14-3"><a></a></span>
<span id="cb14-4"><a></a><span class="co"># Initialize k-fold cross-validation</span></span>
<span id="cb14-5"><a></a>kf <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb14-6"><a></a>accuracies <span class="op">=</span> []</span>
<span id="cb14-7"><a></a></span>
<span id="cb14-8"><a></a><span class="co"># Cross-validation loop</span></span>
<span id="cb14-9"><a></a><span class="cf">for</span> train_index, test_index <span class="kw">in</span> kf.split(X_selected):</span>
<span id="cb14-10"><a></a>    X_train, X_test <span class="op">=</span> X_selected[train_index], X_selected[test_index]</span>
<span id="cb14-11"><a></a>    y_train, y_test <span class="op">=</span> y[train_index], y[test_index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Asked it what is wrong with the code (in a separate chat session)</li>
</ul>
</section>
<section id="section-4" class="slide level2">
<h2></h2>

<img data-src="images/cv_nothing_wrong.png" class="r-stretch"></section>
<section id="section-5" class="slide level2">
<h2></h2>

<!--
## AI refactoring

- "Refactor this code to be PEP8 compliant and use clean coding practices"
  - Refactored code shows no errors or warnings from flake8 linter

::: {#c1557fab .cell execution_count=8}
``` {.python .cell-code}
import pandas as pd
import numpy as np
from scipy.stats import pearsonr
from sklearn.preprocessing import scale
from sklearn.decomposition import FactorAnalysis

MAX_DIM = 12
HEALTH_COLS = [
    'Nervous',
    'Hopeless',
    'RestlessFidgety',
    'Depressed',
    'EverythingIsEffort',
    'Worthless',
]

health_data = pd.read_csv(
    'https://raw.githubusercontent.com/poldrack/clean_coding/master/data/health.csv',
    index_col=0
)[HEALTH_COLS].dropna().mean(axis=1)

data = pd.read_csv(
    'https://raw.githubusercontent.com/poldrack/clean_coding/master/data/meaningful_variables_clean.csv',
    index_col=0
)

survey_columns = [col for col in data.columns if col.split('.')[0][-7:] == '_survey']
data = data[survey_columns]

valid_rows = [i for i in range(data.shape[0]) if not np.isnan(data.iloc[i, :]).any()]
data = data.iloc[valid_rows, :]

data_scaled = scale(data)

bic_values = np.zeros(MAX_DIM)
for i in range(1, MAX_DIM + 1):
    factor_analysis = FactorAnalysis(i)
    factor_analysis.fit(data_scaled)
    bic_values[i - 1] = i * 2 - 2 * factor_analysis.score(data_scaled)

num_dim = np.argmin(bic_values) + 1
factor_analysis = FactorAnalysis(num_dim)
factors = factor_analysis.fit_transform(data_scaled)

for i in range(num_dim):
    print(pearsonr(factors[:, i], health_data[valid_rows]))
    idx = np.argsort(abs(factor_analysis.components_[i, :]))[::-1]
    for j in range(3):
        print(data.columns[idx[j]], factor_analysis.components_[i, idx[j]])

```
:::


## AI programming tools and productivity

![](images/copitlot2.webp){.absolute left=20% height=70%}

::: {.absolute top=88% left=0% style="font-size: 0.6em; text-align: center;"}
https://github.blog/2022-09-07-research-quantifying-github-copilots-impact-on-developer-productivity-and-happiness/
:::

-->
<img data-src="images/cv_problem_found.png" class="r-stretch"></section>
<section id="multimodal-coding-assistance" class="slide level2">
<h2>Multimodal coding assistance</h2>

<img data-src="images/multimodal1.png" class="r-stretch"></section>
<section id="section-6" class="slide level2">
<h2></h2>
<p><img data-src="images/multimodal2.png"></p>
<div class="absolute" style="top: 30%; left: 0%; width: 50%; ">
<p><img data-src="images/multimodal2a.png"></p>
</div>
<div class="absolute" style="top: 30%; left: 50%; width: 50%; ">
<p><img data-src="images/multimodal2b.png"></p>
</div>
</section>
<section id="section-7" class="slide level2">
<h2></h2>
<p><img data-src="images/multimodal3.png" class="absolute" style="top: 0%; left: 0%; height: 85%; "></p>
<p><img data-src="images/multimodal1.png" class="absolute" style="top: 15%; left: 60%; height: 60%; "></p>
</section>
<section id="ai-assisted-coding-workflow" class="slide level2">
<h2>AI-assisted coding workflow</h2>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>ChatGPT with GPT-4 is particularly good at generating code de novo from a prompt
<ul>
<li>Except for math where it makes frequent errors</li>
</ul></li>
<li>Github Copilot is optimal for IDE integration</li>
<li>CoPilot chat with GPT-4 now embedded within VSCode
<ul>
<li>Current code is placed into context</li>
</ul></li>
</ul>
</div></div>
<p><img data-src="images/copilot_chat.png" class="absolute" style="top: 10%; left: 72%; height: 70%; "></p>
</section>
<section id="section-8" class="slide level2">
<h2></h2>
<div class="absolute" style="font-size: 1.5em; text-align: center;top: 40%; ">
<p>AI coding tools will have major implications for science and education in the coming years</p>
</div>
</section>
<section id="how-might-ai-coding-tools-improve-science" class="slide level2">
<h2>How might AI coding tools improve science?</h2>
<ul>
<li>Higher quality of research code
<ul>
<li>Code review/refactoring</li>
<li>Test generation</li>
<li>Generation of simulated data</li>
</ul></li>
<li>It could enable more effective training of researchers in coding
<ul>
<li>Assisted debugging could help improve debugging skills</li>
</ul></li>
</ul>
</section>
<section id="how-might-ai-coding-tools-harm-science" class="slide level2">
<h2>How might AI coding tools harm science?</h2>
<ul>
<li>Lower quality of research code
<ul>
<li>Generation of complex code with lack of understanding by researcher</li>
</ul></li>
<li>AI systems cannot be trusted to test themselves</li>
</ul>
</section>
<section id="ai-generated-code-and-reproducibility" class="slide level2">
<h2>AI-generated code and reproducibility</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>The results of GPT-4 interactions are largely irreproducible unless extra steps are taken
<ul>
<li>It is now possible to set the random seed for inference, but the model can change without warning</li>
<li>System fingerprints are available to detect model changes</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<pre><code>client.chat.completions.create(
  model='gpt-4',
  seed=seed,
  messages=[
    {'role': 'system', 'content': f'You are a helpful assistant'},
    {'role': 'user', 'content': f'Output a random vegetable.'},],)</code></pre>
<pre><code>
# Seed: None
Counter({'Broccoli': 73, 'Carrot': 13, 'Cabbage': 6, 'Cucumber': 4, 'Cauliflower': 3, 'Spinach': 1})

# Seed: 1234
Counter({'Cucumber': 100})</code></pre>
</div></div>
<!--

## Legal issues around AI-generated code {data-background-image="images/courtroom.jpg" data-background-size="100%" data-background-opacity=".1"}

::::{.columns}
::: {.column width="50%"}
- Licensing issues
  - LLMs for code have been built on public code from Github
    - Including code released under viral/copyleft licenses
  - Microsoft/OpenAI claim that this constitutes "fair use"
  - Currently under litigation in the US
:::
::::

![](images/butterick_suit.png){.absolute top=25% height=40% left=55%}

::: {.absolute top=70% left=60% style="font-size: 0.7em; text-align: center;"}
https://githubcopilotlitigation.com/
:::


## Legal issues around AI-generated code {data-background-image="images/courtroom.jpg" data-background-size="100%" data-background-opacity=".1"}

- Potential for liability
  - If Copilot inserts code verbatim from someone else's code (which happens rarely), are you liable for infingement?


## Ethical issues around AI-generated code

- Authorship issues
  - When AI is responsible for a significant proportion of work in a research project, must the researcher disclose this?
  - Does the AI deserve co-authorship?

## Ethical issues around AI-generated code

- Authorship issues
  - When AI is responsible for a significant proportion of work in a research project, must the researcher disclose this?
  - Does the AI deserve co-authorship?

![](images/chatgpt_coauthor_medrxiv.png){.absolute left=5% top=50% height=35%}



## Ethical issues around AI-generated code

- Authorship issues
  - When AI is responsible for a significant proportion of work in a research project, must the researcher disclose this?
  - Does the AI deserve co-authorship?

![](images/chatgpt_coauthor_medrxiv.png){.absolute left=5% top=50% height=35%}
![](images/chatgpt_coauthor_published.png){.absolute left=50% top=50% height=35%}

##

![](images/elsevier_ai1.png){.absolute left=0% width=100% top=0%}

![](images/elsevier_ai2.png){.absolute left=0% width=100% top=40%}

::: {.absolute top=85% left=0% style="font-size: 0.6em; text-align: center;"}
https://www.elsevier.com/about/policies/publishing-ethics/the-use-of-ai-and-ai-assisted-writing-technologies-in-scientific-writing
:::

## Ethical issues around AI-generated code {data-background-image="images/iceberg_melting.jpg" data-background-size="100%" data-background-opacity=".1"}


::::{.columns}
::: {.column width="55%"}
- Environmental impacts
  - Training of LLMs requires substantial energy use
  - Inference requires much less energy but happens much more frequently
  - However, improved model architectures and choice of data center location can substantially reduce carbon impact (Patterson et al., 2021)
:::
::::

![](images/model_emissions.png){.absolute top=25% height=45% left=55%}

::: {.absolute top=85% left=65% style="font-size: 0.7em; text-align: center;"}
https://aiindex.stanford.edu/
:::


## Ethical issues around AI-generated code

- Access issues
  - Access to ChatGPT with GPT-4 is currently restricted to ChatGPT Pro users ($20/month)
  - This could exacerbate inequities between high- and low-resource institutions
- Fairness/bias issues
  - AI coding assistants inherit all of the well-known biases of LLMs
-->
</section>
<section id="educational-issues-around-ai-assisted-coding" class="slide level2">
<h2>Educational issues around AI-assisted coding</h2>
<ul>
<li>How do we assess understanding?
<ul>
<li>It will be increasingly easy for students to complete standard coding problems using AI tools.</li>
</ul></li>
<li>Do we need to teach coding differently?
<ul>
<li>e.g.&nbsp;greater focus on debugging, testing, and code review</li>
<li>Formative assessments using LLM interactions</li>
</ul></li>
</ul>
<div class="absolute" style="font-size: 0.8em; text-align: center;top: 85%; left: 40%; ">
<p>Finnie-Ansley et al, 2022</p>
</div>
</section>
<section id="educational-issues-around-ai-generated-code" class="slide level2">
<h2>Educational issues around AI-generated code</h2>
<ul>
<li>We need to focus more on training students to work with AI tools (aka Programming 3.0)
<ul>
<li>What kinds of new interactions do students need to learn?</li>
</ul></li>
</ul>
<p><img data-src="images/xu-chat-final.png" class="absolute" style="top: 37%; left: 23%; height: 45%; "></p>
<div class="absolute" style="font-size: 0.8em; text-align: center;top: 85%; left: 13%; ">
<p>https://martinfowler.com/articles/2023-chatgpt-xu-hao.html</p>
</div>
</section>
<section id="teaching-test-driven-development" class="slide level2">
<h2>Teaching test-driven development</h2>
<div class="columns">
<div class="column" style="font-size: 0.8em;">
<ul>
<li>Starts by designing a test for the desired behavior(s)
<ul>
<li>Ensuring that the test fails on nonfunctional code</li>
</ul></li>
<li>Then code is developed that can pass the test</li>
<li>Once the code passes, then it is refactored to make it more robust</li>
<li>TDD can ensure that AI-generated code performs as advertised
<ul>
<li>But you have to know how to generate the appropriate tests!</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="images/tdd.png"></p>
</div></div>
</section>
<section id="from-prompt-engineering-to-flow-engineering" class="slide level2">
<h2>From prompt engineering to flow engineering</h2>
<div class="columns">
<div class="column" style="font-size: 0.8em;">
<ul>
<li>AlphaCodium (Ridnik et al., 2024)
<ul>
<li>Starts with a linear reasoning stage in natural language</li>
<li>Then moves to an interative generate/run/fix process</li>
</ul></li>
</ul>
</div></div>
<p><img data-src="images/ridnik_alphacodium_flow.png" class="absolute" style="top: 10%; left: 50%; height: 75%; "></p>
<div class="absolute" style="font-size: 0.6em; text-align: center;top: 85%; left: 65%; ">
<p>Ridnik et al., 2024</p>
</div>
</section>
<section id="from-prompt-engineering-to-flow-engineering-1" class="slide level2">
<h2>From prompt engineering to flow engineering</h2>
<div class="columns">
<div class="column" style="font-size: 0.8em;">
<ul>
<li>Demonstrates several useful principles
<ul>
<li>LLMs reason better using bullet points (by forcing division into semantically distinct sections)</li>
<li>LLMs do better generating modular code</li>
<li>Better to generate multiple solutions and compare them</li>
<li>Iteratively generate new tests but continue to apply the validated tests</li>
</ul></li>
</ul>
</div></div>
<p><img data-src="images/ridnik_alphacodium_flow.png" class="absolute" style="top: 10%; left: 50%; height: 75%; "></p>
<div class="absolute" style="font-size: 0.6em; text-align: center;top: 85%; left: 65%; ">
<p>Ridnik et al., 2024</p>
</div>
<!--
## Philosophical problems

- LLMs have been caricatured as "stochastic parrots" (Bender et al., 2021)
- We have to be skeptical about overblown claims of "understanding" (Sher, 2023)
- However, the newest LLMs exhibit emergent behavior that is hard to dismiss as simple "regurgitation"
  - And analyses of LLMs have begun to identify mechanisms for pattern abstraction (e.g. induction heads; Olsson et al., 2022)
- At what point might be we ready to say that an LLM "understands" how to code?
-->
</section>
<section id="conclusions" class="slide level2">
<h2>Conclusions</h2>
<ul>
<li>AI coding assistants can greatly improve programmer effectiveness
<ul>
<li>But they require care and verification</li>
</ul></li>
<li>AI coding tools can be very useful for coding education
<ul>
<li>We need to focus more on training of logical analysis, testing, and workflow design</li>
</ul></li>
</ul>
</section>
<section id="section-9" class="slide level2">
<h2></h2>
<div class="absolute" style="font-size: 1.5em; text-align: center;top: 12%; left: 3%; ">
<p>The Poldrack Lab</p>
</div>
<p><img data-src="./images/lab_polaroid_rotated.png" class="absolute" style="top: 25%; left: 5%; height: 55%; "></p>
<div class="absolute" style="font-size: 1.5em; text-align: center;top: 12%; left: 57%; ">
<p>Collaborators</p>
</div>
<p><img data-src="./images/gasper-photo-Gasper-Begus-750.jpg" class="absolute" style="top: 25%; left: 50%; height: 25%; "></p>
<p><img data-src="./images/thomas_lu.jpeg" class="absolute" style="top: 25%; left: 75%; height: 25%; "></p>
<div class="absolute" style="font-size: 0.8em; text-align: center;top: 55%; left: 47%; ">
<p>Gasper Begus and Thomas Lu, UC Berkeley</p>
</div>
</section>
<section id="section-10" class="slide level2">
<h2></h2>
</section>
<section id="section-11" class="slide level2" data-background-image="images/openai_gpt-4_visual-e1678820006678.jpg" data-background-size="100%" data-background-opacity=".05">
<h2></h2>
<div class="absolute" style="font-size: 1.5em; text-align: center;top: 40%; left: 5%; ">
<p>How good is the code generated by GPT-4?</p>
</div>
</section>
<section id="clean-coding-and-refactoring" class="slide level2">
<h2>Clean coding and refactoring</h2>
<div class="columns">
<div class="column" style="width:66%;">
<blockquote>
<p>“Clean code is simple and direct. Clean code reads like well-written prose.” - Grady Booch (from Martin, <em>Clean Code</em>)</p>
</blockquote>
<ul>
<li>Clean code uses consistent coding standards</li>
<li>Clean code minimizes complexity</li>
<li>Refactoring
<ul>
<li>Restructuring existing code to make it cleaner or more maintainable without changing its behavior</li>
</ul></li>
</ul>
</div></div>
<p><img data-src="./images/cleancode_cover.png" class="absolute" style="top: 5%; left: 60%; height: 55%; "> <img data-src="./images/refact2.jpg" class="absolute" style="top: 50%; left: 80%; height: 40%; "></p>
</section>
<section id="experiment-2-refactoring-with-gpt-4" class="slide level2">
<h2>Experiment 2: Refactoring with GPT-4</h2>
<ul>
<li>Downloaded 2130 Python files from Github (via API)
<ul>
<li>Only one file per user</li>
<li>272 remained after filtering to avoid autogenerated code and other issues</li>
</ul></li>
<li>Prompt (via GPT-4 API): “Please refactor the following Python code to be more readable, adding or rewriting comments as needed.”</li>
<li>Code quality for original and refactored code assessed using flake8 and radon</li>
</ul>
<div class="absolute" style="top: 85%; left: 20%; ">
<p>With Gašper Beguš and Thomas Lu, UC Berkeley</p>
</div>
</section>
<section id="refactoring-success" class="slide level2">
<h2>Refactoring success</h2>
<ul>
<li>100% of prompts produced code</li>
<li>97% were free of syntax errors (vs 100% of original)</li>
</ul>
</section>
<section id="gpt-4-improves-code-formatting" class="slide level2">
<h2>GPT-4 improves code formatting</h2>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>flake8 linter identifies code formatting problems</li>
<li>Refactored code from GPT4 produces many fewer warnings (per line of code)
<ul>
<li>.24 for original vs .08 for GPT4 (FDR p&lt;.001)</li>
</ul></li>
</ul>
</div></div>
<p><img data-src="images/flake8_messages_per_loc_swarmplot.png" class="absolute" style="top: 10%; left: 45%; height: 70%; "></p>
</section>
<section id="section-12" class="slide level2">
<h2></h2>

<img data-src="images/flake8_errors.png" class="r-stretch"></section>
<section id="gpt-4-reduces-code-complexity" class="slide level2">
<h2>GPT-4 reduces code complexity</h2>
<p><img data-src="images/raw_lloc_swarmplot.png" class="absolute" style="top: 20%; left: 0%; height: 65%; "></p>
<p><img data-src="images/mean_cc_swarmplot.png" class="absolute" style="top: 20%; left: 50%; height: 65%; "></p>
<div class="absolute" style="top: 10%; left: 6%; ">
<p>Reduced # of logical code lines</p>
</div>
<div class="absolute" style="top: 10%; left: 56%; ">
<p>Reduced cyclomatic complexity</p>
</div>
<div class="absolute" style="top: 85%; left: 40%; ">
<p>Both FDR p &lt; .01</p>
</div>
</section>
<section id="halsted-metrics" class="slide level2">
<h2>Halsted metrics</h2>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>Basic quantities:
<ul>
<li><span class="math inline">\(\eta_1\)</span>: # distinct operators</li>
<li><span class="math inline">\(\eta_2\)</span>: # distinct operands</li>
<li>vocabulary size: <span class="math inline">\(\eta = \eta_1 + \eta_2\)</span>:</li>
<li><span class="math inline">\(N_1\)</span>: # total operators</li>
<li><span class="math inline">\(N_2\)</span>: # total operands</li>
<li>program length: <span class="math inline">\(N = N_1 + N_2\)</span></li>
</ul></li>
</ul>
</div><div class="column" style="width:60%;">
<ul>
<li>Derived measures:
<ul>
<li>Volume: <span class="math inline">\(V = N \times log_2 \eta\)</span></li>
<li></li>
</ul></li>
</ul>
</div></div>
</section>
<section id="maintainability-index" class="slide level2" style="font-size:1.4em; ">
<h2>Maintainability index</h2>
<ul>
<li>Function of 4 other metrics:
<ul>
<li>Halstead volume (<span class="math inline">\(V\)</span>)</li>
<li>Cyclomatic complexity (<span class="math inline">\(CC\)</span>)</li>
<li>Source lines of code (<span class="math inline">\(L\)</span>)</li>
<li>Percent of comment lines (converted to radians) (<span class="math inline">\(PC\)</span>)</li>
</ul></li>
</ul>
<p><span class="math display">\[
MI =
\]</span> <span class="math display">\[
max[0, 100 \times \frac{171 − 5.2 ln(V) − 0.23 CC − 16.2 ln(L) + 50 sin(\sqrt{2.4PC}))}{171}]
\]</span></p>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p>https://poldrack.github.io/talks-AIAssistedCoding/</p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>